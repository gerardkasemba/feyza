"use strict";(()=>{var e={};e.id=1493,e.ids=[1493],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3639:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>y,patchFetch:()=>g,requestAsyncStorage:()=>u,routeModule:()=>c,serverHooks:()=>p,staticGenerationAsyncStorage:()=>m});var o={};t.r(o),t.d(o,{GET:()=>d});var a=t(49303),i=t(88716),n=t(60670),s=t(87070),l=t(65655);async function d(e,{params:r}){try{let{id:e}=await r,t=await (0,l.k)(),{data:o,error:a}=await t.from("users").select(`
        id,
        full_name,
        borrower_rating,
        borrower_rating_updated_at,
        total_loans_completed,
        total_payments_made,
        payments_on_time,
        payments_early,
        payments_late,
        payments_missed,
        borrowing_tier,
        verification_status,
        created_at
      `).eq("id",e).single();if(a||!o)return s.NextResponse.json({error:"Borrower not found"},{status:404});let i=o.total_payments_made||0,n=o.payments_on_time||0,d=o.payments_early||0,c=o.payments_late||0,u=o.payments_missed||0,m=function(e){let r={great:{label:"Great Borrower",color:"green",emoji:"⭐",description:"Pays early most of the time. Highly reliable."},good:{label:"Good Borrower",color:"blue",emoji:"\uD83D\uDC4D",description:"Pays on time consistently. Trustworthy."},neutral:{label:"New Borrower",color:"gray",emoji:"\uD83C\uDD95",description:"No payment history yet or limited data."},poor:{label:"Poor Borrower",color:"yellow",emoji:"⚠️",description:"Mixed payment history. Some missed payments."},bad:{label:"Bad Borrower",color:"orange",emoji:"⛔",description:"Frequently late on payments. High risk."},worst:{label:"High Risk",color:"red",emoji:"\uD83D\uDEA8",description:"Rarely or never pays. Avoid lending."}};return r[e]||r.neutral}(o.borrower_rating||"neutral"),{data:p}=await t.from("loans").select("status, amount, created_at").eq("borrower_id",e).order("created_at",{ascending:!1}).limit(10);p?.filter(e=>"completed"===e.status).length;let y=p?.filter(e=>"active"===e.status).length||0,g=p?.filter(e=>"defaulted"===e.status).length||0,h=new Date(o.created_at),w=Math.floor((Date.now()-h.getTime())/2592e6);return s.NextResponse.json({borrower:{id:o.id,name:o.full_name,memberSince:o.created_at,monthsAsMember:w,isVerified:"verified"===o.verification_status,borrowingTier:o.borrowing_tier||1,tierName:function(e){switch(e){case 1:default:return"Starter";case 2:return"Bronze";case 3:return"Silver";case 4:return"Gold";case 5:return"Platinum";case 6:return"Diamond"}}(o.borrowing_tier||1)},rating:{overall:o.borrower_rating||"neutral",...m,lastUpdated:o.borrower_rating_updated_at},paymentHistory:{totalPayments:i,onTime:n,early:d,late:c,missed:u,onTimePercentage:i>0?Math.round((n+d)/i*100):0},loanHistory:{totalCompleted:o.total_loans_completed||0,currentlyActive:y,defaulted:g},recommendation:function(e,r){if(0===r)return"This is a new borrower with no payment history. Consider starting with a small loan amount.";switch(e){case"great":return"Excellent track record! This borrower is highly recommended for lending.";case"good":return"Good payment history. This borrower is generally reliable.";case"neutral":return"Limited payment data available. Consider the loan amount carefully.";case"poor":return"Caution advised. This borrower has missed some payments in the past.";case"bad":return"High risk borrower. Frequently late on payments. Consider carefully before lending.";case"worst":return"Very high risk. This borrower has a history of not paying. Not recommended for lending.";default:return"Unable to determine borrower reliability."}}(o.borrower_rating||"neutral",i)})}catch(e){return console.error("Error fetching borrower profile:",e),s.NextResponse.json({error:"Internal server error"},{status:500})}}let c=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/borrower/[id]/route",pathname:"/api/borrower/[id]",filename:"route",bundlePath:"app/api/borrower/[id]/route"},resolvedPagePath:"C:\\Users\\GerardKasemba\\feyza\\src\\app\\api\\borrower\\[id]\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:u,staticGenerationAsyncStorage:m,serverHooks:p}=c,y="/api/borrower/[id]/route";function g(){return(0,n.patchFetch)({serverHooks:p,staticGenerationAsyncStorage:m})}},65655:(e,r,t)=>{t.d(r,{f:()=>i,k:()=>n});var o=t(67721),a=t(71615);async function i(){let e=await (0,a.cookies)();return(0,o.createServerClient)("https://mregojhoivbxdvgjrixz.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1yZWdvamhvaXZieGR2Z2pyaXh6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc1ODE1NDQsImV4cCI6MjA4MzE1NzU0NH0.I_jEMf00cFYAdF0akvD-HOqXWExxO3E0BV69EHEa5jI",{cookies:{getAll:()=>e.getAll(),setAll(r){try{r.forEach(({name:r,value:t,options:o})=>e.set(r,t,o))}catch{}}}})}async function n(){let e=await (0,a.cookies)();return(0,o.createServerClient)("https://mregojhoivbxdvgjrixz.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY,{cookies:{getAll:()=>e.getAll(),setAll(r){try{r.forEach(({name:r,value:t,options:o})=>e.set(r,t,o))}catch{}}}})}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[9276,3786,9702,5972],()=>t(3639));module.exports=o})();