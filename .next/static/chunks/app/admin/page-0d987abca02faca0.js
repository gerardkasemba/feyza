(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{9024:function(e,t,n){Promise.resolve().then(n.bind(n,8935))},2252:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});let l=(0,n(9763).Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},6858:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});let l=(0,n(9763).Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},8420:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});let l=(0,n(9763).Z)("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]])},5302:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});let l=(0,n(9763).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},1723:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});let l=(0,n(9763).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},5252:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});let l=(0,n(9763).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},8736:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});let l=(0,n(9763).Z)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]])},525:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});let l=(0,n(9763).Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},5805:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});let l=(0,n(9763).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},8935:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return g}});var l=n(7437),s=n(2265),a=n(7648),r=n(8933),i=n(3448),c=n(5805),o=n(8736),d=n(8420),u=n(5252),m=n(9763);let x=(0,m.Z)("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);var h=n(1723),p=n(5302),f=n(2252),v=n(525);let b=(0,m.Z)("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);var y=n(6858);function g(){let[e,t]=(0,s.useState)(null),[n,m]=(0,s.useState)(!0);return((0,s.useEffect)(()=>{(async()=>{let e=(0,r.e)(),[n,l,s,a,i,c,o,d,u]=await Promise.all([e.from("users").select("id",{count:"exact"}),e.from("loans").select("id, amount, amount_paid",{count:"exact"}),e.from("business_profiles").select("id",{count:"exact"}),e.from("loans").select("id",{count:"exact"}).eq("status","active"),e.from("loans").select("id",{count:"exact"}).eq("status","pending"),e.from("loans").select("id",{count:"exact"}).eq("status","completed"),e.from("users").select("*").order("created_at",{ascending:!1}).limit(5),e.from("loans").select("\n          *,\n          borrower:users!borrower_id(full_name, email),\n          lender:users!lender_id(full_name),\n          business_lender:business_profiles!business_lender_id(business_name)\n        ").order("created_at",{ascending:!1}).limit(5),e.from("payment_schedule").select("id",{count:"exact"}).eq("is_paid",!1).lt("due_date",new Date().toISOString().split("T")[0])]),x=l.data||[],h=x.reduce((e,t)=>e+(t.amount||0),0),p=x.reduce((e,t)=>e+(t.amount_paid||0),0);t({totalUsers:n.count||0,totalLoans:l.count||0,totalBusinesses:s.count||0,activeLoans:a.count||0,pendingLoans:i.count||0,completedLoans:c.count||0,totalLoanAmount:h,totalRepaid:p,recentUsers:o.data||[],recentLoans:d.data||[],overduePayments:u.count||0}),m(!1)})()},[]),n)?(0,l.jsx)("div",{className:"p-8",children:(0,l.jsxs)("div",{className:"animate-pulse space-y-6",children:[(0,l.jsx)("div",{className:"h-8 bg-neutral-200 rounded w-48"}),(0,l.jsx)("div",{className:"grid grid-cols-4 gap-6",children:[1,2,3,4].map(e=>(0,l.jsx)("div",{className:"h-32 bg-neutral-200 rounded-xl"},e))})]})}):(0,l.jsxs)("div",{className:"p-8",children:[(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-neutral-900",children:"Admin Dashboard"}),(0,l.jsx)("p",{className:"text-neutral-500",children:"Overview of your platform"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,l.jsx)(j,{title:"Total Users",value:(null==e?void 0:e.totalUsers)||0,icon:c.Z,color:"blue",href:"/admin/users"}),(0,l.jsx)(j,{title:"Total Loans",value:(null==e?void 0:e.totalLoans)||0,icon:o.Z,color:"green",href:"/admin/loans"}),(0,l.jsx)(j,{title:"Businesses",value:(null==e?void 0:e.totalBusinesses)||0,icon:d.Z,color:"purple",href:"/admin/businesses"}),(0,l.jsx)(j,{title:"Total Volume",value:(0,i.xG)((null==e?void 0:e.totalLoanAmount)||0),icon:u.Z,color:"amber"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,l.jsx)(j,{title:"Active Loans",value:(null==e?void 0:e.activeLoans)||0,icon:x,color:"emerald",subtitle:"Currently active"}),(0,l.jsx)(j,{title:"Pending Loans",value:(null==e?void 0:e.pendingLoans)||0,icon:h.Z,color:"yellow",subtitle:"Awaiting approval"}),(0,l.jsx)(j,{title:"Completed",value:(null==e?void 0:e.completedLoans)||0,icon:p.Z,color:"green",subtitle:"Fully repaid"}),(0,l.jsx)(j,{title:"Overdue Payments",value:(null==e?void 0:e.overduePayments)||0,icon:f.Z,color:"red",subtitle:"Need attention"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[(0,l.jsxs)("div",{className:"bg-white rounded-xl border border-neutral-200 p-6",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-neutral-900 mb-4",children:"Financial Overview"}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between p-4 bg-green-50 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)(v.Z,{className:"w-5 h-5 text-green-600"}),(0,l.jsx)("span",{className:"text-neutral-700",children:"Total Loaned"})]}),(0,l.jsx)("span",{className:"font-bold text-green-600",children:(0,i.xG)((null==e?void 0:e.totalLoanAmount)||0)})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between p-4 bg-blue-50 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)(b,{className:"w-5 h-5 text-blue-600"}),(0,l.jsx)("span",{className:"text-neutral-700",children:"Total Repaid"})]}),(0,l.jsx)("span",{className:"font-bold text-blue-600",children:(0,i.xG)((null==e?void 0:e.totalRepaid)||0)})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between p-4 bg-amber-50 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)(u.Z,{className:"w-5 h-5 text-amber-600"}),(0,l.jsx)("span",{className:"text-neutral-700",children:"Outstanding"})]}),(0,l.jsx)("span",{className:"font-bold text-amber-600",children:(0,i.xG)(((null==e?void 0:e.totalLoanAmount)||0)-((null==e?void 0:e.totalRepaid)||0))})]})]})]}),(0,l.jsxs)("div",{className:"bg-white rounded-xl border border-neutral-200 p-6",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-neutral-900 mb-4",children:"Loan Status Distribution"}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsx)(N,{label:"Active",value:(null==e?void 0:e.activeLoans)||0,total:(null==e?void 0:e.totalLoans)||1,color:"emerald"}),(0,l.jsx)(N,{label:"Pending",value:(null==e?void 0:e.pendingLoans)||0,total:(null==e?void 0:e.totalLoans)||1,color:"yellow"}),(0,l.jsx)(N,{label:"Completed",value:(null==e?void 0:e.completedLoans)||0,total:(null==e?void 0:e.totalLoans)||1,color:"blue"})]})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,l.jsxs)("div",{className:"bg-white rounded-xl border border-neutral-200 p-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-neutral-900",children:"Recent Users"}),(0,l.jsxs)(a.default,{href:"/admin/users",className:"text-sm text-primary-600 hover:text-primary-700 flex items-center gap-1",children:["View all ",(0,l.jsx)(y.Z,{className:"w-4 h-4"})]})]}),(0,l.jsx)("div",{className:"space-y-3",children:null==e?void 0:e.recentUsers.map(e=>{var t;return(0,l.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-neutral-50 rounded-lg",children:[(0,l.jsx)("div",{className:"w-10 h-10 bg-primary-100 rounded-full flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-primary-600 font-medium",children:(null===(t=e.full_name)||void 0===t?void 0:t.charAt(0))||"?"})}),(0,l.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,l.jsx)("p",{className:"font-medium text-neutral-900 truncate",children:e.full_name||"Unknown"}),(0,l.jsx)("p",{className:"text-sm text-neutral-500 truncate",children:e.email})]}),(0,l.jsx)("span",{className:"px-2 py-1 text-xs rounded-full ".concat("business"===e.user_type?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"),children:e.user_type||"individual"})]},e.id)})})]}),(0,l.jsxs)("div",{className:"bg-white rounded-xl border border-neutral-200 p-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-neutral-900",children:"Recent Loans"}),(0,l.jsxs)(a.default,{href:"/admin/loans",className:"text-sm text-primary-600 hover:text-primary-700 flex items-center gap-1",children:["View all ",(0,l.jsx)(y.Z,{className:"w-4 h-4"})]})]}),(0,l.jsx)("div",{className:"space-y-3",children:null==e?void 0:e.recentLoans.map(e=>{var t,n,s;return(0,l.jsxs)("div",{className:"flex items-center justify-between p-3 bg-neutral-50 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,l.jsx)("p",{className:"font-medium text-neutral-900 truncate",children:(null===(t=e.borrower)||void 0===t?void 0:t.full_name)||"Unknown"}),(0,l.jsxs)("p",{className:"text-sm text-neutral-500",children:["From: ",(null===(n=e.lender)||void 0===n?void 0:n.full_name)||(null===(s=e.business_lender)||void 0===s?void 0:s.business_name)||"Personal"]})]}),(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsx)("p",{className:"font-medium text-neutral-900",children:(0,i.xG)(e.amount,e.currency)}),(0,l.jsx)("span",{className:"text-xs px-2 py-0.5 rounded-full ".concat("active"===e.status?"bg-green-100 text-green-700":"pending"===e.status?"bg-yellow-100 text-yellow-700":"completed"===e.status?"bg-blue-100 text-blue-700":"bg-neutral-100 text-neutral-700"),children:e.status})]})]},e.id)})})]})]})]})}function j(e){let{title:t,value:n,icon:s,color:r,href:i,subtitle:c}=e,o=(0,l.jsxs)("div",{className:"bg-white rounded-xl border border-neutral-200 p-6 hover:shadow-lg transition-shadow",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsx)("div",{className:"p-3 rounded-xl ".concat({blue:"bg-blue-100 text-blue-600",green:"bg-green-100 text-green-600",purple:"bg-purple-100 text-purple-600",amber:"bg-amber-100 text-amber-600",emerald:"bg-emerald-100 text-emerald-600",yellow:"bg-yellow-100 text-yellow-600",red:"bg-red-100 text-red-600"}[r]),children:(0,l.jsx)(s,{className:"w-6 h-6"})}),i&&(0,l.jsx)(y.Z,{className:"w-5 h-5 text-neutral-400"})]}),(0,l.jsx)("p",{className:"text-sm text-neutral-500 mb-1",children:t}),(0,l.jsx)("p",{className:"text-2xl font-bold text-neutral-900",children:n}),c&&(0,l.jsx)("p",{className:"text-xs text-neutral-400 mt-1",children:c})]});return i?(0,l.jsx)(a.default,{href:i,children:o}):o}function N(e){let{label:t,value:n,total:s,color:a}=e,r=s>0?n/s*100:0;return(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,l.jsx)("span",{className:"text-sm text-neutral-600",children:t}),(0,l.jsx)("span",{className:"text-sm font-medium text-neutral-900",children:n})]}),(0,l.jsx)("div",{className:"h-2 bg-neutral-100 rounded-full overflow-hidden",children:(0,l.jsx)("div",{className:"h-full ".concat({emerald:"bg-emerald-500",yellow:"bg-yellow-500",blue:"bg-blue-500",red:"bg-red-500"}[a]," rounded-full transition-all"),style:{width:"".concat(r,"%")}})})]})}},8933:function(e,t,n){"use strict";n.d(t,{e:function(){return s}});var l=n(4033);function s(){return(0,l.createBrowserClient)("https://mregojhoivbxdvgjrixz.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1yZWdvamhvaXZieGR2Z2pyaXh6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc1ODE1NDQsImV4cCI6MjA4MzE1NzU0NH0.I_jEMf00cFYAdF0akvD-HOqXWExxO3E0BV69EHEa5jI")}},3448:function(e,t,n){"use strict";n.d(t,{K2:function(){return b},QT:function(){return f},U6:function(){return y},VO:function(){return p},aT:function(){return v},cn:function(){return o},p6:function(){return u},rl:function(){return x},xG:function(){return d},yv:function(){return h},zg:function(){return m}});var l=n(1994),s=n(3335),a=n(2093),r=n(5710),i=n(9121),c=n(3430);function o(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,s.m6)((0,l.W)(t))}function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"USD";return new Intl.NumberFormat("en-US",{style:"currency",currency:t,minimumFractionDigits:0,maximumFractionDigits:2}).format(e)}function u(e){return(0,a.WU)(new Date(e),"MMM d, yyyy")}function m(e){return(0,r.Q)(new Date(e),{addSuffix:!0})}function x(e){return"".concat(e.toFixed(2),"%")}function h(e,t){if(t)return"paid";let n=new Date(e),l=new Date,s=(0,i.E)(l,3);return(0,c.R)(n,l)?"overdue":(0,c.R)(n,s)?"due":"upcoming"}function p(e,t){return 0===t?0:Math.round(e/t*100)}function f(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t="";for(let n=0;n<32;n++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}function v(e,t,n,l){return 0===t?0:"simple"===l?t/100/12*e*n:function(e,t,n){let l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:12;return e*Math.pow(1+t/100/l,n/12*l)-e}(e,t,n)}function b(e,t){switch(t){case"weekly":return e/4.33;case"biweekly":return e/2.17;default:return e}}function y(e){let{amount:t,repaymentAmount:n,totalInstallments:l,startDate:s,frequency:a,interestRate:r=0,interestType:c="simple"}=e,o=[],d=v(t,r,b(l,a),c),u=d/l,m=t/l,x=new Date(s),h=t,p=d;for(let e=0;e<l;e++){let t=e===l-1,n=t?h:Math.min(m,h),s=t?p:Math.min(u,p),r=n+s;switch(o.push({dueDate:new Date(x),amount:Math.round(100*r)/100,principalAmount:Math.round(100*n)/100,interestAmount:Math.round(100*s)/100}),h-=n,p-=s,a){case"weekly":x=(0,i.E)(x,7);break;case"biweekly":x=(0,i.E)(x,14);break;case"monthly":x.setMonth(x.getMonth()+1);break;default:x=(0,i.E)(x,30)}}return o}}},function(e){e.O(0,[1114,7648,4033,2971,2117,1744],function(){return e(e.s=9024)}),_N_E=e.O()}]);