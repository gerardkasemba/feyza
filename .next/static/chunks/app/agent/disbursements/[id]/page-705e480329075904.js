(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3858],{5737:function(e,s,t){Promise.resolve().then(t.bind(t,8811))},2252:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(9763).Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},3639:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(9763).Z)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},2660:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(9763).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},3681:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(9763).Z)("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]])},44:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(9763).Z)("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]])},5302:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(9763).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},875:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(9763).Z)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},407:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(9763).Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},1723:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(9763).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},8226:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(9763).Z)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},9637:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(9763).Z)("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]])},3245:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(9763).Z)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},5863:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(9763).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},9227:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(9763).Z)("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]])},3041:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(9763).Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]])},4743:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(9763).Z)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]])},3388:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(9763).Z)("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]])},2369:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(9763).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},5131:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(9763).Z)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},2489:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(9763).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},9376:function(e,s,t){"use strict";var n=t(5475);t.o(n,"useParams")&&t.d(s,{useParams:function(){return n.useParams}}),t.o(n,"usePathname")&&t.d(s,{usePathname:function(){return n.usePathname}}),t.o(n,"useRouter")&&t.d(s,{useRouter:function(){return n.useRouter}}),t.o(n,"useSearchParams")&&t.d(s,{useSearchParams:function(){return n.useSearchParams}})},8811:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return k}});var n=t(7437),a=t(2265),i=t(9376),r=t(7648),l=t(2573),c=t(3448),d=t(1723),o=t(3681),u=t(5302),m=t(5131),h=t(9227),x=t(2660),p=t(2369),f=t(3388),y=t(44),j=t(8226),b=t(3041),N=t(4743);let v=(0,t(9763).Z)("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);function k(){var e,s,t,k,g,w,_,Z;let M=(0,i.useRouter)(),C=(0,i.useParams)().id,[P,z]=(0,a.useState)(null),[A,S]=(0,a.useState)(!0),[R,q]=(0,a.useState)(null),[D,H]=(0,a.useState)(""),[B,L]=(0,a.useState)(null);(0,a.useEffect)(()=>{E()},[C]);let E=async()=>{try{let e=await fetch("/api/agent/disbursements/".concat(C));if(!e.ok){M.push("/agent/dashboard");return}let s=await e.json();z(s.disbursement)}catch(e){console.error("Failed to fetch disbursement:",e)}finally{S(!1)}},T=async function(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(s&&!D.trim()){L(e);return}q(e);try{let s=await fetch("/api/agent/disbursements/".concat(C),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:e,notes:D.trim()||void 0})});if(s.ok)await E(),H(""),L(null);else{let e=await s.json();alert(e.error||"Action failed")}}catch(e){console.error("Action failed:",e),alert("Action failed")}finally{q(null)}};if(A)return(0,n.jsx)("div",{className:"min-h-screen bg-neutral-50 flex items-center justify-center",children:(0,n.jsx)("div",{className:"animate-spin w-8 h-8 border-4 border-primary-500 border-t-transparent rounded-full"})});if(!P)return null;let V=!["completed","failed"].includes(P.status);return(0,n.jsxs)("div",{className:"min-h-screen bg-neutral-50",children:[(0,n.jsx)("header",{className:"bg-white border-b border-neutral-200 sticky top-0 z-50",children:(0,n.jsx)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,n.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,n.jsxs)(r.default,{href:"/agent/dashboard",className:"flex items-center gap-2 text-neutral-600 hover:text-neutral-900",children:[(0,n.jsx)(x.Z,{className:"w-5 h-5"}),"Back to Dashboard"]}),(e=>{let s={pending:{variant:"warning",label:"Pending",icon:d.Z},processing:{variant:"default",label:"Processing",icon:d.Z},ready_for_pickup:{variant:"warning",label:"Ready for Pickup",icon:o.Z},completed:{variant:"success",label:"Completed",icon:u.Z},failed:{variant:"danger",label:"Failed",icon:m.Z},on_hold:{variant:"default",label:"On Hold",icon:h.Z}},t=s[e]||s.pending,a=t.icon;return(0,n.jsxs)(l.Ct,{variant:t.variant,className:"text-base px-4 py-2",children:[(0,n.jsx)(a,{className:"w-4 h-4 mr-2"}),t.label]})})(P.status)]})})}),(0,n.jsxs)("main",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,n.jsx)(l.Zb,{className:"mb-6 bg-gradient-to-br from-primary-500 to-primary-600 text-white",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("p",{className:"text-primary-100",children:"Amount to Disburse"}),(0,n.jsx)("p",{className:"text-4xl font-bold mt-2",children:(0,c.xG)(P.amount,P.currency)}),P.local_amount&&(0,n.jsxs)("p",{className:"text-primary-200 mt-2",children:["≈ ",(0,c.xG)(P.local_amount,P.local_currency||""),P.exchange_rate&&" (Rate: ".concat(P.exchange_rate,")")]})]})}),(0,n.jsxs)("div",{className:"grid md:grid-cols-2 gap-6 mb-6",children:[(0,n.jsxs)(l.Zb,{children:[(0,n.jsxs)("h3",{className:"font-semibold text-neutral-900 mb-4 flex items-center gap-2",children:[(0,n.jsx)(p.Z,{className:"w-5 h-5"}),"Recipient Details"]}),(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-neutral-500",children:"Name"}),(0,n.jsx)("span",{className:"font-medium",children:P.recipient_name})]}),P.recipient_phone&&(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-neutral-500",children:"Phone"}),(0,n.jsx)("span",{className:"font-medium",children:P.recipient_phone})]}),P.recipient_country&&(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-neutral-500",children:"Country"}),(0,n.jsx)("span",{className:"font-medium",children:P.recipient_country})]}),P.recipient_id_type&&(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-neutral-500",children:"ID Type"}),(0,n.jsx)("span",{className:"font-medium",children:P.recipient_id_type})]}),P.recipient_id_number&&(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-neutral-500",children:"ID Number"}),(0,n.jsx)("span",{className:"font-mono",children:P.recipient_id_number})]}),(0,n.jsxs)("div",{className:"flex justify-between items-center pt-2 border-t",children:[(0,n.jsx)("span",{className:"text-neutral-500",children:"Verified"}),P.recipient_verified?(0,n.jsxs)("span",{className:"flex items-center gap-1 text-green-600",children:[(0,n.jsx)(u.Z,{className:"w-4 h-4"}),"Verified"]}):(0,n.jsx)("span",{className:"text-yellow-600",children:"Not Verified"})]})]})]}),(0,n.jsxs)(l.Zb,{children:[(0,n.jsxs)("h3",{className:"font-semibold text-neutral-900 mb-4 flex items-center gap-2",children:["mobile_money"===P.disbursement_method&&(0,n.jsx)(f.Z,{className:"w-5 h-5"}),"bank_transfer"===P.disbursement_method&&(0,n.jsx)(y.Z,{className:"w-5 h-5"}),"cash_pickup"===P.disbursement_method&&(0,n.jsx)(o.Z,{className:"w-5 h-5"}),"mobile_money"===P.disbursement_method&&"Mobile Money","bank_transfer"===P.disbursement_method&&"Bank Transfer","cash_pickup"===P.disbursement_method&&"Cash Pickup"]}),"mobile_money"===P.disbursement_method&&(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-neutral-500",children:"Provider"}),(0,n.jsx)("span",{className:"font-medium",children:P.mobile_provider})]}),(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-neutral-500",children:"Number"}),(0,n.jsx)("span",{className:"font-mono",children:P.mobile_number})]}),P.mobile_name&&(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-neutral-500",children:"Name on Account"}),(0,n.jsx)("span",{className:"font-medium",children:P.mobile_name})]})]}),"bank_transfer"===P.disbursement_method&&(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-neutral-500",children:"Bank"}),(0,n.jsx)("span",{className:"font-medium",children:P.bank_name})]}),(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-neutral-500",children:"Account Name"}),(0,n.jsx)("span",{className:"font-medium",children:P.bank_account_name})]}),(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-neutral-500",children:"Account Number"}),(0,n.jsx)("span",{className:"font-mono",children:P.bank_account_number})]}),P.bank_branch&&(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-neutral-500",children:"Branch"}),(0,n.jsx)("span",{className:"font-medium",children:P.bank_branch})]})]}),"cash_pickup"===P.disbursement_method&&(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-neutral-500",children:"Location"}),(0,n.jsx)("span",{className:"font-medium",children:P.pickup_location})]}),(0,n.jsxs)("div",{className:"pt-3 mt-3 border-t",children:[(0,n.jsx)("p",{className:"text-neutral-500 text-sm mb-2",children:"Pickup Code"}),(0,n.jsx)("div",{className:"bg-neutral-100 p-4 rounded-xl text-center",children:(0,n.jsx)("span",{className:"text-3xl font-bold font-mono tracking-widest",children:P.pickup_code})})]})]})]})]}),(0,n.jsxs)(l.Zb,{className:"mb-6",children:[(0,n.jsxs)("h3",{className:"font-semibold text-neutral-900 mb-4 flex items-center gap-2",children:[(0,n.jsx)(j.Z,{className:"w-5 h-5"}),"Borrower (Diaspora)"]}),(0,n.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("div",{className:"w-10 h-10 bg-neutral-100 rounded-full flex items-center justify-center",children:(0,n.jsx)(p.Z,{className:"w-5 h-5 text-neutral-500"})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"font-medium",children:(null===(s=P.loan)||void 0===s?void 0:null===(e=s.borrower)||void 0===e?void 0:e.full_name)||"Unknown"}),(0,n.jsx)("p",{className:"text-sm text-neutral-500",children:null===(k=P.loan)||void 0===k?void 0:null===(t=k.borrower)||void 0===t?void 0:t.email})]})]}),(null===(w=P.loan)||void 0===w?void 0:null===(g=w.borrower)||void 0===g?void 0:g.phone)&&(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("div",{className:"w-10 h-10 bg-neutral-100 rounded-full flex items-center justify-center",children:(0,n.jsx)(b.Z,{className:"w-5 h-5 text-neutral-500"})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"font-medium",children:null===(Z=P.loan)||void 0===Z?void 0:null===(_=Z.borrower)||void 0===_?void 0:_.phone}),(0,n.jsx)("p",{className:"text-sm text-neutral-500",children:"Phone"})]})]})]})]}),V&&(0,n.jsxs)(l.Zb,{className:"mb-6",children:[(0,n.jsx)("h3",{className:"font-semibold text-neutral-900 mb-4",children:"Actions"}),(0,n.jsxs)("div",{className:"flex flex-wrap gap-3",children:["pending"===P.status&&(0,n.jsxs)(l.zx,{onClick:()=>T("assign"),loading:"assign"===R,children:[(0,n.jsx)(u.Z,{className:"w-4 h-4 mr-2"}),"Assign to Me & Start Processing"]}),!P.recipient_verified&&"pending"!==P.status&&(0,n.jsxs)(l.zx,{variant:"outline",onClick:()=>T("verify",!0),loading:"verify"===R,children:[(0,n.jsx)(u.Z,{className:"w-4 h-4 mr-2"}),"Verify Recipient"]}),"processing"===P.status&&"cash_pickup"===P.disbursement_method&&(0,n.jsxs)(l.zx,{onClick:()=>T("ready_for_pickup"),loading:"ready_for_pickup"===R,children:[(0,n.jsx)(o.Z,{className:"w-4 h-4 mr-2"}),"Mark Ready for Pickup"]}),["processing","ready_for_pickup"].includes(P.status)&&(0,n.jsxs)(l.zx,{className:"bg-green-600 hover:bg-green-700",onClick:()=>T("complete",!0),loading:"complete"===R,children:[(0,n.jsx)(N.Z,{className:"w-4 h-4 mr-2"}),"Complete Disbursement"]}),V&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(l.zx,{variant:"outline",onClick:()=>T("hold",!0),loading:"hold"===R,children:[(0,n.jsx)(h.Z,{className:"w-4 h-4 mr-2"}),"Put on Hold"]}),(0,n.jsxs)(l.zx,{variant:"outline",className:"text-red-600 border-red-200 hover:bg-red-50",onClick:()=>T("fail",!0),loading:"fail"===R,children:[(0,n.jsx)(m.Z,{className:"w-4 h-4 mr-2"}),"Mark as Failed"]})]})]})]}),B&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,n.jsxs)(l.Zb,{className:"w-full max-w-md",children:[(0,n.jsx)("h3",{className:"font-semibold text-neutral-900 mb-4",children:"Add Notes"}),(0,n.jsx)("textarea",{value:D,onChange:e=>H(e.target.value),placeholder:"Enter notes for this action...",className:"w-full p-3 border border-neutral-200 rounded-xl min-h-[100px] focus:ring-2 focus:ring-primary-500"}),(0,n.jsxs)("div",{className:"flex gap-3 mt-4",children:[(0,n.jsx)(l.zx,{variant:"outline",onClick:()=>L(null),children:"Cancel"}),(0,n.jsx)(l.zx,{onClick:()=>T(B),loading:R===B,children:"Confirm"})]})]})}),P.history&&P.history.length>0&&(0,n.jsxs)(l.Zb,{children:[(0,n.jsxs)("h3",{className:"font-semibold text-neutral-900 mb-4 flex items-center gap-2",children:[(0,n.jsx)(v,{className:"w-5 h-5"}),"Activity History"]}),(0,n.jsx)("div",{className:"space-y-4",children:P.history.map((e,s)=>{var t;return(0,n.jsxs)("div",{className:"flex gap-4",children:[(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("div",{className:"w-8 h-8 bg-neutral-100 rounded-full flex items-center justify-center",children:(0,n.jsx)(d.Z,{className:"w-4 h-4 text-neutral-500"})}),s<P.history.length-1&&(0,n.jsx)("div",{className:"absolute top-8 left-1/2 -translate-x-1/2 w-0.5 h-full bg-neutral-200"})]}),(0,n.jsxs)("div",{className:"flex-1 pb-4",children:[(0,n.jsx)("p",{className:"font-medium text-neutral-900 capitalize",children:e.action.replace("_"," ")}),e.notes&&(0,n.jsx)("p",{className:"text-sm text-neutral-500 mt-1",children:e.notes}),(0,n.jsxs)("p",{className:"text-xs text-neutral-400 mt-1",children:[new Date(e.created_at).toLocaleString(),(null===(t=e.metadata)||void 0===t?void 0:t.agent_name)&&" • ".concat(e.metadata.agent_name)]})]})]},e.id)})})]})]})]})}}},function(e){e.O(0,[1114,7648,2573,2971,2117,1744],function(){return e(e.s=5737)}),_N_E=e.O()}]);